;
(self.AMP=self.AMP||[]).push({m:1,v:"2310301456000",n:"amp-video-iframe",ev:"0.1",l:!0,f:function(t,i){(()=>{var{isArray:i}=Array;function n(t){return i(t)?t:[t]}var e,{hasOwnProperty:s,toString:o}=Object.prototype;function r(t){return"[object Object]"===o.call(t)}function a(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function l(t){return"number"==typeof t&&isFinite(t)}function u(t,i,n,e,s,o,r,a,l,u,c){return t}function c(){return e||(e=Promise.resolve(void 0))}var h=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}};function d(t){return new Promise((i=>{i(t())}))}var f="registered",m="load",p="playing",v="pause",_="ended",P="muted",g="unmuted",A="ad_start",y="ad_end",b="amp:video:tick",M="playing_manual",R="paused",w="video-play",E="user-interacted";function I(t){t.signals().signal(E)}var T=[p,v,_,P,g,A,y];function V(t,i){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null==i||i(t),null}}function k(t){return(t.ownerDocument||t).defaultView}var S,x,C,q={bubbles:!0,cancelable:!0};function O(t){var i;null===(i=t.parentElement)||void 0===i||i.removeChild(t)}function j(t,i,n,e){const s=n||{};u(t.ownerDocument);const{bubbles:o,cancelable:r}=e||q,a=new MessageEvent(i,{data:s,bubbles:o,cancelable:r});t.dispatchEvent(a)}function F(t,i){t.classList.add("i-amphtml-fill-content"),i&&t.classList.add("i-amphtml-replaced-content")}function $(t,i,n={}){const{needsRootBounds:e,rootMargin:s,threshold:o}=n,r=function(t){return t.parent&&t.parent!=t}(i)&&(e||s)?i.document:void 0;return new i.IntersectionObserver(t,{threshold:o,root:r,rootMargin:s})}function z(t){var i;let n=null===(i=S)||void 0===i?void 0:i.get(t);if(!n){const i=function(t){S||(S=new WeakMap,x=new WeakMap),u(x);let i=x.get(t);return i||(i=$((t=>{const n=new Set;for(let s=t.length-1;s>=0;s--){var e;const{target:o}=t[s];n.has(o)||(n.add(o),u(i),i.unobserve(o),u(S),null===(e=S.get(o))||void 0===e||e.resolve(t[s]),S.delete(o))}}),t,{needsRootBounds:!0}),x.set(t,i)),i}(k(t));u(S),i.observe(t),n=new h,S.set(t,n)}return n.promise}function L(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:n,stack:e}=t,s=new Error(n);for(const i in t)s[i]=t[i];return s.stack=e,s}function U(t){let i=null,n="";for(const t of arguments)t instanceof Error&&!i?i=L(t):(n&&(n+=" "),n+=t);return i?n&&(i.message=n+": "+i.message):i=new Error(n),i}function Y(t){var i,n;null===(i=(n=self).__AMP_REPORT_ERROR)||void 0===i||i.call(n,t)}function D(t,...i){try{return t.apply(null,i)}catch(t){!function(t){const i=U.apply(null,arguments);setTimeout((()=>{throw Y(i),i}))}(t)}}function N(t){const i=U.apply(null,arguments);return i.expected=!0,i}function W(t,...i){Y(N.apply(null,i))}var B=["Webkit","webkit","Moz","moz","ms","O","o"],J={"getPropertyPriority":()=>"","getPropertyValue":()=>""};function H(t,i,n,e,s){const o=function(t,i,n){if(i.startsWith("--"))return i;C||(C=a());let e=C[i];if(!e||n){if(e=i,void 0===t[i]){const n=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),s=function(t,i){for(let n=0;n<B.length;n++){const e=B[n]+i;if(void 0!==t[e])return e}return""}(t,n);void 0!==t[s]&&(e=s)}n||(C[i]=e)}return e}(t.style,i,s);if(!o)return;const r=e?n+e:n;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return B.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(o),r)}var Z=/vertical/,G=new WeakMap,K=new WeakMap,Q=new WeakMap;function X(t){let i=G.get(t);return i||(i=new t.ResizeObserver(tt),G.set(t,i)),i}function tt(t){const i=new Set;for(let n=t.length-1;n>=0;n--){const e=t[n],{target:s}=e;if(i.has(s))continue;i.add(s);const o=K.get(s);if(o){Q.set(s,e);for(let t=0;t<o.length;t++){const{callback:i,type:n}=o[t];it(n,i,e)}}}}function it(t,i,n){if(0==t){const{contentRect:t}=n,{height:e,width:s}=t;D(i,{width:s,height:e})}else if(1==t){const{borderBoxSize:t}=n;let e;if(t)e=t.length>0?t[0]:{inlineSize:0,blockSize:0};else{const{target:t}=n,i=k(t),s=Z.test(function(t,i){return t.getComputedStyle(i)||J}(i,t).writingMode),{offsetHeight:o,offsetWidth:r}=t;let a,l;s?(l=r,a=o):(a=r,l=o),e={inlineSize:a,blockSize:l}}D(i,e)}}function nt(t){let i=!1,n=null,e=t;return(...t)=>(i||(n=e.apply(self,t),i=!0,e=null),n)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var et=self.__AMP_LOG;function st(t){return et.user||(et.user=ot()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(et.user.win,t)?et.userForEmbed||(et.userForEmbed=ot()):et.user}function ot(t){return function(t,i){throw new Error("failed to call initLogConstructor")}()}function rt(t,i,n,e,s,o,r,a,l,u,c){return t}function at(t,i,n,e,s,o,r,a,l,u,c){return st().assert(t,i,n,e,s,o,r,a,l,u,c)}function lt(t,i){return mt(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function ut(t,i){return mt(ft(dt(t)),i)}function ct(t,i){const n=ft(dt(t));return _t(n,i)?mt(n,i):null}function ht(t,i){return pt(ft(t),i)}function dt(t){return t.nodeType?(i=k(t),lt(i,"ampdoc")).getAmpDoc(t):t;var i}function ft(t){const i=dt(t);return i.isSingleDoc()?i.win:i}function mt(t,i){rt(_t(t,i));const n=vt(t)[i];return n.obj||(rt(n.ctor),rt(n.context),n.obj=new n.ctor(n.context),rt(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}function pt(t,i){const n=vt(t)[i];return n?n.promise?n.promise:(mt(t,i),n.promise=Promise.resolve(n.obj)):null}function vt(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}function _t(t,i){const n=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!n||!n.ctor)}var Pt,gt,At=t=>ct(t,"action"),yt=t=>lt(t,"platform"),bt=t=>mt(t,"timer"),Mt=t=>function(t,i,n,e){const s=ht(t,i);if(s)return s;const o=dt(t);return o.whenExtensionsKnown().then((()=>{const t=o.getExtensionVersion(n);return t?lt(o.win,"extensions").waitForExtension(n,t):null})).then((n=>n?function(t,i){return function(t,i){const n=pt(t,i);if(n)return n;const e=vt(t);return e[i]=function(){const t=new h,{promise:i,reject:n,resolve:e}=t;return i.catch((()=>{})),{obj:null,promise:i,resolve:e,reject:n,context:null,ctor:null}}(),e[i].promise}(ft(t),i)}(t,i):null))}(t,"consentPolicyManager","amp-consent"),Rt=t=>ct(t,"url"),wt=t=>ut(t,"viewport");function Et(t){return null==t.__AMP_AUTOPLAY&&(t.__AMP_AUTOPLAY=function(t){const i=t.document.createElement("video");var n;return i.setAttribute("muted",""),i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline",""),i.setAttribute("height","0"),i.setAttribute("width","0"),i.muted=!0,i.playsInline=!0,i.playsinline=!0,i.webkitPlaysinline=!0,function(t,i){for(const n in i)H(t,n,i[n])}(i,{position:"fixed",top:"0",width:"0",height:"0",opacity:"0"}),n=i,d((()=>n.play())).catch((()=>{})),Promise.resolve(!i.paused)}(t)),t.__AMP_AUTOPLAY}function It(t){return t.querySelector("video, iframe")}function Tt(t,i){const n=d((()=>t.play(!!i)));return n.catch((t=>{W(0,t)})),n}function Vt(t,i,n,e){let s=t,o=n,r=t=>{try{return o(t)}catch(t){var i,n;throw null===(i=(n=self).__AMP_REPORT_ERROR)||void 0===i||i.call(n,t),t}};const a=function(){if(void 0!==Pt)return Pt;Pt=!1;try{const t={get capture(){return Pt=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return Pt}(),l=!(null==e||!e.capture);return s.addEventListener(i,r,a?e:l),()=>{null==s||s.removeEventListener(i,r,a?e:l),o=null,s=null,r=null}}function kt(t,i,n,e){const s={detail:n};return Object.assign(s,e),new t.CustomEvent(i,s)}function St(t,i,n,e){return Vt(t,i,n,e)}function xt(t){return t.data}function Ct(t){const i=t.ownerDocument||t;return gt&&gt.ownerDocument===i||(gt=i.createElement("div")),qt}function qt(t){return function(t,i){if(u(1===i.length),u(Array.isArray(i)||(n=i,s.call(n,"raw"))),self.trustedTypes&&self.trustedTypes.createPolicy){const n=self.trustedTypes.createPolicy("static-template#createNode",{createHTML:function(t){return i[0]}});t.innerHTML=n.createHTML("ignored")}else t.innerHTML=i[0];var n;const e=t.firstElementChild;return u(e),u(!e.nextElementSibling),t.removeChild(e),e}(gt,t)}var Ot=['<button aria-label="Unmute video" class="i-amphtml-video-mask i-amphtml-fill-content" tabindex=0></button>'],jt=["<i-amphtml-video-icon class=amp-video-eq><div class=amp-video-eq-col><div class=amp-video-eq-filler></div><div class=amp-video-eq-filler></div></div></i-amphtml-video-icon>"];function Ft(t,i,n){if(i[n])return i[n];const e=t.querySelector(`style[${n}], link[${n}]`);return e?(i[n]=e,e):null}function $t(t,i){const n=t.styleSheets;for(let t=0;t<n.length;t++)if(n[t].ownerNode==i)return!0;return!1}var zt=class{constructor(){this.gv=!1,this.Pv=new class{constructor(){this.Vt=null}add(t){return this.Vt||(this.Vt=[]),this.Vt.push(t),()=>{this.remove(t)}}remove(t){this.Vt&&function(t,i){const n=t.indexOf(i);-1!=n&&t.splice(n,1)}(this.Vt,t)}removeAll(){this.Vt&&(this.Vt.length=0)}fire(t){if(this.Vt)for(const i of this.Vt.slice())i(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.Vt)||void 0===i?void 0:i.length)&&void 0!==t?t:0}}}onSessionEnd(t){this.Pv.add(t)}beginSession(){this.gv=!0}endSession(){this.gv&&this.Pv.fire(),this.gv=!1}isSessionActive(){return this.gv}},Lt={"title":"","artist":"","album":"","artwork":[{"src":""}]},Ut="video-manager",Yt=(t,i)=>!!t&&(t.video===i||t.video.element===i);function Dt(t,i){const n=i.top+i.height/2,e=t.getSize().height/2;return Math.abs(n-e)}function Nt(t){return 10*t*5}var Wt=t=>!!t&&!isNaN(t)&&t>1;function Bt(t,i,n){const{video:e}=t;t.getAnalyticsDetails().then((t=>{n&&Object.assign(t,n),j(e.element,i,t)}))}function Jt(t){!function(t,n,e,s){const o=dt(t),h=ft(o);!function(t,i,n,e,s,o){const r=vt(t);let a=r[n];a||(a=r[n]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),a.ctor||(a.ctor=e,a.context=i,a.sharedInstance=!1,a.resolve&&mt(t,n))}(h,o,n,class{constructor(t){this.ampdoc=t,this.installAutoplayStyles=nt((()=>function(t){!function(t,i,n,e,s){const o=t.getHeadNode(),r=function(t,i,n,e){let s=t.__AMP_CSS_SM;s||(s=t.__AMP_CSS_SM=a());const o=!n&&e&&"amp-custom"!=e&&"amp-keyframes"!=e,r=n?"amp-runtime":o?`amp-extension=${e}`:null;if(r){const n=Ft(t,s,r);if(n)return"STYLE"==n.tagName&&n.textContent!==i&&(n.textContent=i),n}const l=(t.ownerDocument||t).createElement("style");l.textContent=i;let u=null;return n?l.setAttribute("amp-runtime",""):o?(l.setAttribute("amp-extension",e||""),u=Ft(t,s,"amp-runtime")):(e&&l.setAttribute(e,""),u=t.lastChild),function(t,i,n=null){if(!n)return void function(t,i){t.insertBefore(i,t.firstChild)}(t,i);const e=n.nextSibling;t.insertBefore(i,e)}(t,l,u),r&&(s[r]=l),l}(o,function(t,i){const n=t.__AMP_CSS_TR;return n?n(i):i}(o,i),e||!1,s||null);if(n){const i=t.getRootNode();if($t(i,r))return n(r),r;const e=setInterval((()=>{$t(i,r)&&(clearInterval(e),n(r))}),4)}}(t,".i-amphtml-video-mask{display:block;z-index:1;-webkit-appearance:none;appearance:none;background:transparent;border:none}.amp-video-eq{display:none}.i-amphtml-video-interface:not(amp-video) .amp-video-eq,amp-story .amp-video-eq,amp-video[controls] .amp-video-eq{display:-ms-flexbox;display:flex}[noaudio] .amp-video-eq{display:none!important}.amp-video-eq{pointer-events:none!important;-ms-flex-align:end;align-items:flex-end;bottom:7px;height:12px;opacity:0.8;overflow:hidden;position:absolute;right:7px;width:20px;z-index:1}.amp-video-eq-col{-ms-flex:1;flex:1;height:100%;margin-right:1px;position:relative}.amp-video-eq-col div{animation-name:amp-video-eq-animation;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate;background-color:#fafafa;height:100%;position:absolute;width:100%;will-change:transform;animation-play-state:paused}.amp-video-eq-play .amp-video-eq-col div{animation-play-state:running}.amp-video-eq-1-1{animation-duration:0.3s;transform:translateY(60%)}.amp-video-eq-1-2{animation-duration:0.45s;transform:translateY(60%)}.amp-video-eq-2-1{animation-duration:0.5s;transform:translateY(30%)}.amp-video-eq-2-2{animation-duration:0.4s;transform:translateY(30%)}.amp-video-eq-3-1{animation-duration:0.3s;transform:translateY(70%)}.amp-video-eq-3-2{animation-duration:0.35s;transform:translateY(70%)}.amp-video-eq-4-1{animation-duration:0.4s;transform:translateY(50%)}.amp-video-eq-4-2{animation-duration:0.25s;transform:translateY(50%)}@keyframes amp-video-eq-animation{0%{transform:translateY(100%)}to{transform:translateY(0)}}\n/*# sourceURL=/css/video-autoplay.css*/",null,!1,"amp-video-autoplay")}(this.ampdoc))),this.Av=null,this.yv=null,this.bv=null,this.fn=bt(t.win),this.Mv=At(t.getHeadNode()),this.Ev=()=>this.Tv(),this.Vv=nt((()=>new class{constructor(t,i){this.Rv=i,this.ji=t,this.Iv=null,this.kv=null,this.Av=[],this.Sv=[],this.qv=()=>this.xv(),this.Cv=t=>this.Ov(t)==M,this.Fv=(t,i)=>this.zv(t,i),this.jv(),this.Yv()}dispose(){this.Sv.forEach((t=>t())),this.Sv.length=0}register(t){const{video:i}=t,{element:n}=i;this.Dv(n)&&(this.Av.push(i),St(n,v,this.qv),St(n,p,this.qv),St(n,_,this.qv),i.signals().whenSignal(E).then(this.qv),this.xv())}Yv(){const t=this.ji.getRootNode(),i=()=>this.Lv();this.Sv.push(St(t,"webkitfullscreenchange",i),St(t,"mozfullscreenchange",i),St(t,"fullscreenchange",i),St(t,"MSFullscreenChange",i))}isInLandscape(){return(t=this.ji.win).screen&&"orientation"in t.screen?t.screen.orientation.type.startsWith("landscape"):90==Math.abs(t.orientation);var t}Dv(t){if("video"==It(t).tagName.toLowerCase())return!0;const i=yt(this.ji.win);return!i.isIos()&&!i.isSafari()||function(t){return!!{"amp-dailymotion":!0,"amp-ima-video":!0}[t.tagName.toLowerCase()]}(t)}Lv(){this.Iv=null}jv(){const{win:t}=this.ji,{screen:i}=t;if(i&&"orientation"in i){const t=i.orientation;this.Sv.push(St(t,"change",(()=>this.$v())))}this.Sv.push(St(t,"orientationchange",(()=>this.$v())))}$v(){this.isInLandscape()?null!=this.kv&&this.Nv(this.kv):this.Iv&&this.Wv(this.Iv)}Nv(t){const i=yt(this.ji.win);this.Iv=t,i.isAndroid()&&i.isChrome()?t.fullscreenEnter():this.Bv(t).then((()=>t.fullscreenEnter()))}Wv(t){this.Iv=null,this.Bv(t,"center").then((()=>t.fullscreenExit()))}Bv(t,i=null){const{element:n}=t,e=this.Uv();return this.Jv().then((()=>z(n))).then((({boundingClientRect:t})=>{const{bottom:s,top:o}=t,r=e.getSize().height;if(o>=0&&s<=r)return c();const a=i||(s>r?"bottom":"top");return e.animateScrollIntoView(n,a)}))}Uv(){return wt(this.ji)}Jv(){return bt(this.ji.win).promise(330)}xv(){if(this.isInLandscape())return Promise.resolve(this.kv);this.kv=null;const t=this.Av.filter(this.Cv).map((t=>z(t.element)));return Promise.all(t).then((t=>{const i=t.sort(this.Fv)[0];return i&&i.intersectionRatio>.5?i.target.getImpl().then((t=>this.kv=t)):this.kv}))}zv(t,i){const{boundingClientRect:n,intersectionRatio:e}=t,{boundingClientRect:s,intersectionRatio:o}=i,r=e-o;if(Math.abs(r)>.1)return r;const a=wt(this.ji),l=Dt(a,n),u=Dt(a,s);return l<u||l>u?l-u:n.top-s.top}Ov(t){return this.Rv.getPlayingState(t)}}(this.ampdoc,this))),this.fn.delay(this.Ev,1e3)}dispose(){if(this.Vv().dispose(),this.yv.disconnect(),this.yv=null,this.Av)for(let t=0;t<this.Av.length;t++)this.Av[t].dispose()}Tv(){for(let t=0;t<this.Av.length;t++){const i=this.Av[t];i.getPlayingState()!==R&&(Bt(i,"video-seconds-played"),this.Hv(i))}this.fn.delay(this.Ev,1e3)}Hv(t){const i="timeUpdate",n=t.video.getCurrentTime(),e=t.video.getDuration();if(l(n)&&l(e)&&e>0){const s=n/e,o=kt(this.ampdoc.win,`${Ut}.${i}`,{"time":n,"percent":s});this.Mv.trigger(t.video.element,i,o,1)}}register(t){rt(t);const n=t;if(this.Zv(t),!t.supportsPlatform())return;if(this.Gv(t))return;if(!this.yv){const t=t=>t.forEach((({isIntersecting:t,target:i})=>{this.Kv(i).updateVisibility(t)}));this.yv=$(t,this.ampdoc.win,{threshold:.5})}this.yv.observe(n.element),St(n.element,"reloaded",(()=>e.videoLoaded())),this.Av=this.Av||[];const e=new class{constructor(t,i){this.Rv=t,this.ji=t.ampdoc,this.video=i,this.Qv=!0,this.Xv=!1,this.a_=!1,this.l_=!1,this.ps=!1,this.c_=new zt,this.c_.onSessionEnd((()=>Bt(this,"video-session"))),this.d_=new zt,this.d_.onSessionEnd((()=>Bt(this,"video-session-visible"))),this.f_=nt((()=>new class{constructor(t,i){this.fn=bt(t),this.m_=i,this.Sv=null,this.p_=0,this.v_=0}start(){const{element:t}=this.m_.video;this.stop(),this.Sv=this.Sv||[],this.__()?this.g_(this.v_):this.Sv.push(function(t,i,n,e){let s=n;const o=Vt(t,"loadedmetadata",(t=>{try{s(t)}finally{s=null,o()}}),void 0);return o}(t,0,(()=>{this.__()&&this.g_(this.v_)}))),this.Sv.push(St(t,_,(()=>{this.__()&&this.P_(100)})))}stop(){if(this.Sv){for(;this.Sv.length>0;)this.Sv.pop()();this.v_++}}__(){const{video:t}=this.m_,i=t.getDuration();if(!Wt(i))return!1;if(Nt(i)<250){const i=Math.ceil(5);this.A_("This video is too short for `video-percentage-played`. Reports may be innacurate. For best results, use videos over",i,"seconds long.",t.element)}return!0}A_(...t){st().warn.apply(st(),[Ut].concat(t))}g_(t){if(t!=this.v_)return;const{m_:i,fn:n}=this,{video:e}=i,s=()=>this.g_(t);if(i.getPlayingState()==R)return void n.delay(s,500);const o=e.getDuration();if(!Wt(o))return void n.delay(s,500);const r=(h=Nt(o),u(!0),Math.min(Math.max(h,250),4e3)),a=e.getCurrentTime()/o*100,c=5*Math.floor(a/5);var h;rt(l(c)),this.P_(c),n.delay(s,r)}P_(t){t<=0||this.p_!=t&&(this.p_=t,this.y_(t))}y_(t){Bt(this.m_,"video-percentage-played",{"normalizedPercentage":t.toString()})}}(this.ji.win,this))),this.b_=!1,this.w_=!1,this.M_=null,this.dt=!1,this.E_=!1,this.hasAutoplay=i.element.hasAttribute("autoplay"),this.hasAutoplay&&this.Rv.installAutoplayStyles(),this.T_=Lt,this.V_=()=>{Tt(this.video,!1)},this.R_=()=>{this.video.pause()},St(i.element,m,(()=>this.videoLoaded())),St(i.element,v,(()=>this.I_())),St(i.element,"play",(()=>{this.E_=!0,Bt(this,w)})),St(i.element,p,(()=>this.k_())),St(i.element,P,(()=>this.dt=!0)),St(i.element,g,(()=>{this.dt=!1,this.Rv.pauseOtherVideos(this)})),St(i.element,b,(t=>{const i=xt(t),n=i.eventType;n&&this.S_(n,i.vars)})),St(i.element,_,(()=>{this.l_=!1,Bt(this,"video-ended")})),St(i.element,A,(()=>{this.l_=!0,Bt(this,"video-ad-start")})),St(i.element,y,(()=>{this.l_=!1,Bt(this,"video-ad-end")})),i.signals().whenSignal(f).then((()=>this.q_())),this.x_=nt((()=>{const t="firstPlay",i=kt(this.ji.win,t,{}),{element:n}=this.video;At(n).trigger(n,t,i,1)})),this.C_()}dispose(){this.f_().stop()}S_(t,i){const n={"__amp:eventType":t};Object.keys(i).forEach((t=>{n[`custom_${t}`]=i[t]})),Bt(this,"video-hosted-custom",n)}C_(){this.video.signals().whenSignal("playback-delegated").then((()=>{this.Qv=!1,this.a_&&this.video.pause()}))}isMuted(){return this.dt}isPlaybackManaged(){return this.Qv}q_(){this.O_()&&this.Rv.registerForAutoFullscreen(this),this.hasAutoplay&&this.F_()}O_(){const{element:t}=this.video;return!(this.video.preimplementsAutoFullscreen()||!t.hasAttribute("rotate-to-fullscreen"))&&at(this.video.isInteractive(),"Only interactive videos are allowed to enter fullscreen on rotate. Set the `controls` attribute on %s to enable.",t)}k_(){this.a_=!0,this.getPlayingState()==M&&(this.x_(),this.Rv.pauseOtherVideos(this));const{video:t}=this,{element:n}=t;t.preimplementsMediaSessionAPI()||n.classList.contains("i-amphtml-disable-mediasession")||(function(t,n){const e=Rt(t);if(n&&n.artwork){const{artwork:t}=n;rt(i(t)),t.forEach((t=>{if(t){const i=r(t)?t.src:t;at(e.isProtocolValid(i))}}))}}(n,this.T_),function(t,i,n,e){const{navigator:s}=t;"mediaSession"in s&&t.MediaMetadata&&(s.mediaSession.metadata=new t.MediaMetadata(Lt),s.mediaSession.metadata=new t.MediaMetadata(i),s.mediaSession.setActionHandler("play",n),s.mediaSession.setActionHandler("pause",e))}(this.ji.win,this.T_,this.V_,this.R_)),this.c_.beginSession(),this.ps&&this.d_.beginSession(),this.E_||Bt(this,w)}I_(){Bt(this,"video-pause"),this.a_=!1,this.w_?this.w_=!1:this.c_.endSession()}videoLoaded(){this.Xv=!0,this.M_=It(this.video.element),this.z_(),this.f_().start(),this.ps&&this.j_()}z_(){if(this.video.preimplementsMediaSessionAPI())return;this.video.getMetadata()&&(this.T_=a(this.video.getMetadata()));const t=this.ji.win.document;if(!this.T_.artwork||0==this.T_.artwork.length){const i=function(t){const i=t.querySelector('script[type="application/ld+json"]');if(!i)return;const n=V(i.textContent);return n&&n.image?"string"==typeof n.image?n.image:n.image["@list"]&&"string"==typeof n.image["@list"][0]?n.image["@list"][0]:"string"==typeof n.image.url?n.image.url:"string"==typeof n.image[0]?n.image[0]:void 0:void 0}(t)||function(t){const i=t.querySelector('meta[property="og:image"]');return i?i.getAttribute("content"):void 0}(t)||function(t){const i=t.querySelector('link[rel="shortcut icon"]')||t.querySelector('link[rel="icon"]');return i?i.getAttribute("href"):void 0}(t);i&&(this.T_.artwork=[{"src":i}])}if(!this.T_.title){const i=this.video.element.getAttribute("title")||this.video.element.getAttribute("aria-label")||this.M_.getAttribute("title")||this.M_.getAttribute("aria-label")||t.title;i&&(this.T_.title=i)}}Y_(){this.Xv&&this.j_()}j_(){this.ji.isVisible()&&Et(this.ji.win).then((t=>{this.hasAutoplay&&!this.userInteracted()&&t?this.D_():this.L_()}))}F_(){this.video.isInteractive()&&this.video.hideControls(),Et(this.ji.win).then((t=>{t||!this.video.isInteractive()?(this.video.mute(),this.N_()):this.video.showControls()}))}N_(){const{video:t}=this,{element:i,win:n}=this.video;if(i.hasAttribute("noaudio")||i.signals().get(E))return;const e=function(t,i){const n=Ct(i)(jt),e=n.firstElementChild;for(let t=0;t<4;t++){const i=e.cloneNode(!0),s=i.children;for(let i=0;i<s.length;i++)s[i].classList.add(`amp-video-eq-${t+1}-${i+1}`);n.appendChild(i)}return O(e),n}(0,i),s=[e];function o(i){t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{!function(t,i){void 0===i&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden","")}(t,i)}))}))}function r(i){t.mutateElementSkipRemeasure((()=>e.classList.toggle("amp-video-eq-play",i)))}const a=[St(i,v,(()=>r(!1))),St(i,p,(()=>r(!0))),St(i,A,(()=>{o(!1),t.showControls()})),St(i,y,(()=>{o(!0),t.hideControls()})),St(i,g,(()=>I(t)))];if(t.isInteractive()){t.hideControls();const n=function(t,i){const n=Ct(t)(Ot);return i&&i.title&&n.setAttribute("aria-label",i.title),n}(i,this.T_);s.push(n),a.push(St(n,"click",(()=>I(t))))}t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{i.appendChild(t)}))})),this.l_&&o(!1),t.signals().whenSignal(E).then((()=>{this.x_(),t.isInteractive()&&t.showControls(),t.unmute(),a.forEach((t=>{t()})),t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{O(t)}))}))}))}D_(){this.Qv&&(this.ps?(this.d_.beginSession(),Tt(this.video,!0),this.b_=!0):(this.a_&&this.d_.endSession(),this.video.pause(),this.w_=!0))}L_(){this.ps?this.d_.beginSession():this.a_&&this.d_.endSession()}updateVisibility(t){const i=this.ps;this.ps=t,t!=i&&this.Y_()}getPlayingState(){return this.a_?this.a_&&this.b_&&!this.userInteracted()?"playing_auto":M:R}isRollingAd(){return this.l_}userInteracted(){return null!=this.video.signals().get(E)}getAnalyticsDetails(){const{video:t}=this;return Promise.all([Et(this.ji.win),z(t.element)]).then((i=>{const n=i[0],e=i[1],{height:s,width:o}=e.boundingClientRect,r=this.hasAutoplay&&n,a=t.getPlayedRanges(),l=a.reduce(((t,i)=>t+i[1]-i[0]),0);return{"autoplay":r,"currentTime":t.getCurrentTime(),"duration":t.getDuration(),"height":s,"id":t.element.id,"muted":this.dt,"playedTotal":l,"playedRangesJson":JSON.stringify(a),"state":this.getPlayingState(),"width":o}}))}}(this,t);this.Av.push(e);const{element:s}=e.video;j(s,f),function(t){t.classList.add("i-amphtml-media-component")}(s),t.signals().signal(f),s.classList.add("i-amphtml-video-interface")}Zv(t){n("play",(()=>Tt(t,!1))),n("pause",(()=>t.pause())),n("mute",(()=>t.mute())),n("unmute",(()=>t.unmute()));const i=()=>t.fullscreenEnter();function n(i,n){t.registerAction(i,(()=>{I(t),n()}),1)}n("fullscreenenter",i),n("fullscreen",i)}Gv(t){if(Yt(this.bv,t))return this.bv;for(let i=0;this.Av&&i<this.Av.length;i++){const n=this.Av[i];if(Yt(n,t))return this.bv=n,n}return null}Kv(t){return rt(this.Gv(t))}registerForAutoFullscreen(t){this.Vv().register(t)}W_(){return this.Vv()}getVideoStateProperty(t,i){const n=this.ampdoc.getRootNode(),e=st().assertElement(n.getElementById(t),`Could not find an element with id="${t}" for VIDEO_STATE`),s=this.Kv(e);return(s?s.getAnalyticsDetails():c()).then((t=>t?t[i]:""))}getPlayingState(t){return this.Kv(t).getPlayingState()}isMuted(t){return this.Kv(t).isMuted()}userInteracted(t){return this.Kv(t).userInteracted()}isRollingAd(t){return this.Kv(t).isRollingAd()}pauseOtherVideos(t){this.Av.forEach((i=>{i.isPlaybackManaged()&&i!==t&&i.getPlayingState()==M&&i.video.pause()}))}})}(t,"video-manager")}var Ht=["<iframe frameborder=0 allowfullscreen></iframe>"],Zt="amp-video-iframe",Gt=["allow-scripts","allow-same-origin","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation-by-user-activation"],Kt=nt((()=>new RegExp("^video-custom-"))),Qt=(t,i)=>function(t,i){return function(t,i,n){if(!i)return t;const e=t.split("#",2),s=e[0].split("?",2);let o=s[0]+(s[1]?`?${s[1]}&${i}`:`?${i}`);return o+=e[1]?`#${e[1]}`:"",o}(t,function(t){const i=[];for(const o in t){let r=t[o];if(null!=r){r=n(r);for(let t=0;t<r.length;t++)i.push((e=o,s=r[t],`${encodeURIComponent(e)}=${encodeURIComponent(s)}`))}}var e,s;return i.join("&")}(i))}(t,function(t,i,n){const{dataset:e}=t,s={},o=/^param(.+)/;for(const t in e){const i=t.match(o);i&&(s[i[1][0].toLowerCase()+i[1].substr(1)]=e[t])}return s}(i));function Xt(t){const i=t.querySelector('script[type="application/ld+json"]');return i&&V(i.textContent)}var ti=class extends t.BaseElement{constructor(t){super(t),this.U_=null,this.wg=null,this.QP=null,this.XP=!1,this.mA=t=>this.ct(t),this.Q_=new class{constructor(t){this.el=t,this.a_=!1,this.X_=!1,this.vg=this.vg.bind(this)}updatePlaying(t){t!==this.a_&&(this.a_=t,t?(this.X_=!1,function(t,i){!function(t,i,n){const e=t.ownerDocument.defaultView;if(!e)return;let s=K.get(t);if(s||(s=[],K.set(t,s),X(e).observe(t)),!s.some((t=>t.callback===n&&1===t.type))){s.push({type:1,callback:n});const i=Q.get(t);i&&setTimeout((()=>it(1,n,i)))}}(t,0,i)}(this.el,this.vg)):function(t,i){!function(t,i,n){const e=K.get(t);if(e&&(function(t,i){const e=[];let s=0;for(let i=0;i<t.length;i++){const r=t[i];(o=r).callback===n&&1===o.type?e.push(r):(s<i&&(t[s]=r),s++)}var o;s<t.length&&(t.length=s)}(e),0==e.length)){K.delete(t),Q.delete(t);const i=t.ownerDocument.defaultView;i&&X(i).unobserve(t)}}(t,0,i)}(this.el,this.vg))}vg({blockSize:t,inlineSize:i}){const n=i>0&&t>0;if(n===this.X_)return;this.X_=n;const e=this.el;n||e.pause()}}(this.element)}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}buildCallback(){Jt(this.element)}layoutCallback(){this.user().assert(!function(t){const{height:i,width:n}=t.getLayoutSize();return!(n>10||i>10||function(t,i){return t.closest(".i-amphtml-overlay")}(t))}(this.element),"<amp-video-iframe> does not allow tracking iframes. Please use amp-analytics instead.");const t=JSON.stringify(this.pA());var i;return this.U_=(function(t,i){for(const n in i)t.setAttribute(n,i[n])}(i=function(t,i,e,s){const{element:o}=t,r=Ct(o)(Ht);return e&&r.setAttribute("name",e),s&&r.setAttribute("sandbox",s.join(" ")),function(t,i,e,s){const o=n(["referrerpolicy"]);for(const t of o){const n=i.getAttribute(t);null!==n&&e.setAttribute(t,n)}}(0,t.element,r),r.src=Rt(o).assertHttpsUrl(i,o),F(r),o.appendChild(r),r}(this,this.Ug(),t,Gt),{"scrolling":"no"}),H(i,"overflow","hidden"),i),this.wg=St(this.win,"message",this.mA),this.vA().then((()=>this.Eg()))}mutatedAttributesCallback(t){t.src&&this._A()}_A(){const t=this.U_;t&&t.src!=this.Ug()&&(t.src=this.Ug())}pA(){const{canonicalUrl:t,sourceUrl:i}=ut(this.element,"documentInfo").get(),n=this.getAmpDoc().getRootNode(),{documentElement:e,title:s}=n;return{"sourceUrl":i,"canonicalUrl":t,"title":s||null,"lang":(null==e?void 0:e.lang)||null,"jsonLd":Xt(n)}}Eg(){const{element:t}=this;var i;(i=t,ut(i,"video-manager")).register(this),j(t,m)}createPlaceholderCallback(){const{element:t}=this,i=t.getAttribute("poster");if(!i)return null;const n=new Image;return n.src=Qt(i,t),n.setAttribute("loading","lazy"),n.setAttribute("placeholder",""),F(n),n}unlayoutCallback(){return this.XP=!1,this.PA(),this.Q_.updatePlaying(!1),!0}PA(){this.XP=!1,this.U_&&(O(this.U_),this.U_=null),this.wg&&(this.wg(),this.wg=null)}Ug(){const{element:t}=this,i=Rt(t),n=t.getAttribute("src");return i.getSourceOrigin(n),i.getWinOrigin(this.win),function(t){return t.indexOf("#")>-1?t:`${t}#amp=1`}(Qt(n,t))}vA(){return this.QP=new h,this.QP.promise}gA(t){return function(t,i,n){return!(!i||t.source!=i.contentWindow)&&("string"==typeof n?n==t.origin:n.test(t.origin))}(t,this.U_,/.*/)}ct(t){if(!this.U_)return;if(!this.gA(t))return;const i=xt(t);if(!(n=i)||!r(n)&&!n.startsWith("{"))return;var n;const e=r(s=i)?s:V(s);var s;if(null==e)return;const o=e.method;if(o){const t=e.id;return"getIntersection"==o?z(this.element).then((i=>{this.AA(t,i)})):"getConsentData"===o?void this.yA(t):void at(!1,"Unknown method `%s`.",o)}const a=e.event,l="canplay"==a;this.XP=this.XP||l;const{reject:u,resolve:c}=rt(this.QP);if(l)return c();if("error"==a&&!this.XP)return u("Received `error` event.");if("analytics"!=a){switch(a){case"playing":this.Q_.updatePlaying(!0);break;case"pause":case"ended":this.Q_.updatePlaying(!1)}T.indexOf(a)>-1&&j(this.element,a)}else{const t=rt(e.analytics);this.bA(t.eventType,t.vars)}}bA(t,i={}){st().assertString(t,"`eventType` missing in analytics event"),at(Kt().test(t),"Invalid analytics `eventType`. Value must start with `%s`.","video-custom-"),j(this.element,b,{"eventType":t,"vars":i})}AA(t,i){const{intersectionRatio:n,time:e}=i,s=n<.5?0:n;this.Ig({"id":t,"args":{"intersectionRatio":s,"time":e}})}yA(t){var i,n;(i=this.element,n=this.getConsentPolicy(),Mt(i).then((t=>{const i={"consentMetadata":t&&t.getConsentMetadataInfo,"consentString":t&&t.getConsentStringInfo,"consentPolicyState":t&&t.whenPolicyResolved,"consentPolicySharedData":t&&t.getMergedSharedData};return t?Promise.all(Object.keys(i).map((e=>i[e].call(t,n||"default").then((t=>({[e]:t})))))).then((t=>Object.assign.apply({},t))):i}))).then((i=>{this.Ig({"id":t,"args":i})}))}MA(t){const{promise:i}=this.QP||{};i&&i.then((()=>{this.Ig({"event":"method","method":t})}))}Ig(t){this.U_&&this.U_.contentWindow&&this.U_.contentWindow.postMessage(JSON.stringify(t),"*")}pauseCallback(){this.pause()}pause(){this.MA("pause")}play(){this.MA("play")}mute(){this.MA("mute")}unmute(){this.MA("unmute")}isInteractive(){return!0}supportsPlatform(){return!0}preimplementsMediaSessionAPI(){return this.element.hasAttribute("implements-media-session")}preimplementsAutoFullscreen(){return this.element.hasAttribute("implements-rotate-to-fullscreen")}fullscreenEnter(){this.MA("fullscreenenter")}fullscreenExit(){this.MA("fullscreenexit")}isFullscreen(){return!!this.U_&&function(t){const{webkitDisplayingFullscreen:i}=t;if(void 0!==i)return i;const{ownerDocument:n}=t;return!!n&&(n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.webkitCurrentFullScreenElement)==t}(this.U_)}showControls(){this.MA("showcontrols")}hideControls(){this.MA("hidecontrols")}getMetadata(){}getDuration(){return 0}getCurrentTime(){return 0}getPlayedRanges(){return[]}seekTo(t){this.user().error(Zt,"`seekTo` not supported.")}};t.registerElement(Zt,ti)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-video-iframe-0.1.mjs.map